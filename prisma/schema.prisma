generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String        @id @default(uuid())
  email        String        @unique
  name         String?
  role         String
  createdAt    DateTime      @default(now())
  firebaseUid  String?       @unique
  bookings     Booking[]
  guide        Guide?
  hikerProfile HikerProfile?
  reviews      Review[]
}

model Guide {
  id              String    @id @default(uuid())
  userId          String    @unique
  bio             String?
  createdAt       DateTime  @default(now())
  photoUrl        String?
  displayName     String?
  languages       String[]
  yearsExperience Int?
  isVerified      Boolean   @default(false)
  verifiedAt      DateTime?
  verifiedBy      String?
  profileSlug     String?
  isFeatured      Boolean   @default(false)
  updatedAt       DateTime  @updatedAt
  location        String?
  user            User      @relation(fields: [userId], references: [id])
  hikes           Hike[]
  reviews         Review[]
}

model HikerProfile {
  id                  String   @id @default(uuid())
  userId              String   @unique
  bio                 String?
  displayName         String?
  interests           String[]
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  location            String?
  emergencyContact    String?
  fitnessLevel        String?
  medicalInfo         String?
  photoUrl            String?
  preferredDifficulty String[]
  user                User     @relation(fields: [userId], references: [id])
}

model Hike {
  id            String          @id @default(uuid())
  title         String
  description   String?
  price         Int?
  createdAt     DateTime        @default(now())
  guideId       String
  capacity      Int?
  date          DateTime?
  location      String?
  coverUrl      String?
  distance      String?
  duration      String?
  gpxPath       String?
  meetingTime   String?
  updatedAt     DateTime        @updatedAt
  difficulty    DifficultyLevel
  elevationGain String?
  meetingPlace  String?
  whatToBring   String?
  bookings      Booking[]
  guide         Guide           @relation(fields: [guideId], references: [id], onDelete: Cascade)
  mapLocation   Json?
  route         Json?
  routePath     String?


}

model Booking {
  id        String   @id @default(uuid())
  userId    String
  hikeId    String
  status    String
  createdAt DateTime @default(now())
  hike      Hike     @relation(fields: [hikeId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id])
}

model Review {
  id        String   @id @default(uuid())
  userId    String
  guideId   String
  rating    Int
  comment   String?
  createdAt DateTime @default(now())
  guide     Guide    @relation(fields: [guideId], references: [id])
  user      User     @relation(fields: [userId], references: [id])
}

enum DifficultyLevel {
  EASY
  MODERATE
  HARD
}
